var baseJs={firstClick:!0,cId:"",init:function(){var e=this;e.protocol=window.location.protocol,e.showId=e._getQueryString("si"),e.containerID=e._getQueryString("containerID"),e.cId=e.containerID,e.ua=e.isWeiXin(),window.addEventListener("message",function(t){if(e.containerID!=t.data.containerID)return!1;if("ADDataReady"==t.data.action&&(window.newAwards=t.data.data,window.clickPlugin=t.data.clickPlugin,window.gameData=t.data.pluginData,window.backupData=t.data.backupData,e.game=t.data.game,e.setGameData()),"doOnce"==t.data.action&&(window.fireShowId=t.data.si,window.actionType=t.data.actionType,window.newAwards&&("initiative"==t.data.actionType?($(".start").trigger("mousedown"),$(".start").trigger("mouseup"),$(".start").trigger("click")):$(".start").trigger("click"))),"askOpenDialog"==t.data.action&&window.parent.postMessage({action:"openMyAward",containerID:e.containerID,list:JSON.parse(window.localStorage.getItem("myAward"))},"*"),"lotteryCallback"==t.data.action){var n={curl:t.data.curl,desc:t.data.desc,dj_btntext:t.data.dj_btntext,img:t.data.img,award:t.data.data.dj_rpamount};window.newAwards.ads||(window.newAwards.ads=[]),window.newAwards.ads.unshift(n)}}),e.getInfos(),e.openAward(),e.openRule()},_getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null},_getDeviceInfo:function(){return navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?2:1},_ajax:function(e,t,n,a,i){return $.ajax({url:e,data:t||{},type:n||"POST",async:a||!0,success:i,error:function(e){console.log("line 114 Error")}})},_setRem:function(){var e=document.documentElement,t="orientationchange"in window?"orientationchange":"resize",n=function(){var t=e.clientWidth||375;(t=t>750?750:t)&&(e.style.fontSize=t/375*20+"px",window.remscale=t/375)};document.addEventListener&&(window.addEventListener(t,n,!1),document.addEventListener("DOMContentLoaded",n,!1))},isWeiXin:function(){return"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)?1:0},getLoaded:function(e){var t,n=this,a=n.dateTime(new Date,"date");if(!n.showId)return!1;try{localStorage.getItem("DZPMinDateTime"+n.showId)?(t=localStorage.getItem("DZPMinDateTime"+n.showId),a!=t&&(localStorage.removeItem("enterFirst"),localStorage.setItem("DZPMinDateTime"+n.showId,a))):localStorage.setItem("DZPMinDateTime"+n.showId,a)}catch(e){n.getCookie("DZPMinDateTime"+n.showId)?(t=n.getCookie("DZPMinDateTime"+n.showId),a!=dateTime&&(localStorage.removeItem("enterFirst"),n.setCookie("DZPMinDateTime"+n.showId,a))):n.setCookie("DZPMinDateTime"+n.showId,a)}},setCookie:function(e,t){var n=new Date;n.setTime(n.getTime()+2592e6),document.cookie=e+"="+escape(t)+";expires="+n.toGMTString()},getCookie:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null},delCookie:function(e){var t=this,n=new Date;n.setTime(n.getTime()-1);var a=t.getCookie(e);null!=a&&(document.cookie=e+"="+a+";expires="+n.toGMTString())},dateTime:function(e,t){var n=this,a=e;if(e){var i=new Date(e),o=i.getFullYear()+"-"+n.addZero(i.getMonth()+1)+"-"+n.addZero(i.getDate()),r=n.addZero(i.getHours())+":"+n.addZero(i.getMinutes())+":"+n.addZero(i.getSeconds());a="date"===t?o:"time"===t?r:o+" "+r}return a},addZero:function(e){return e<10?"0"+e:e},askData:function(){window.parent.postMessage({action:"askADData",containerID:this.containerID,si:this.showId},"*")},openDialog:function(e){"bingo"==e.type?window.parent.postMessage({action:"openDialog",data:e,containerID:this.containerID,si:this.showId},"*"):window.parent.postMessage({action:"openMyAward",containerID:this.containerID,list:JSON.parse(window.localStorage.getItem("myAward")),sort:"initiative",typeName:e.type},"*")},getInfos:function(){var e=0,t=this,n=window.setInterval(function(){if(e++,window.newAwards){for(var a in newAwards.ads)newAwards.ads[a].impurl=newAwards.impurl,newAwards.ads[a].imptk.push(newAwards.impurl+newAwards.ads[a].imparg);window.clearInterval(n),("fire"===window.backupData[0].isFire||window.fireShowId)&&("initiative"==window.actionType?($(".start").trigger("mousedown"),$(".start").trigger("mouseup"),$(".start").trigger("click")):$(".start").trigger("click"))}e>3&&!window.newAwards&&(t.askData(),e=0)},100)},adShowPV:function(e){var t=(e.imptk,this);$.each(e.imptk,function(e,n){t.sendLog(n)})},adclick:function(e,t,n){var a=this,i=e.clktk.join(",");i=i.replace("__EVENT_TIME_START__",t).replace("__EVENT_TIME_END__",n),$.each(i.split(","),function(e,t){a.sendLog(t)})},adClickPlugin:function(e,t,n){var a=this,i=window.clickPlugin;if(!window.clickPlugin)return!1;i=i.replace("__EVENT_TIME_START__",e).replace("__EVENT_TIME_END__",t).replace("__ACT_NUM__",n),$.each(i.split(","),function(e,t){a.sendLog(t)})},getUID:function(){function e(e){var t,n=1,a=0;if(e)for(n=0,t=e.length-1;t>=0;t--)a=e.charCodeAt(t),n=(n<<6&268435455)+a+(a<<14),a=266338304&n,n=0!=a?n^a>>21:n;return n}return(""+e(document.referrer)+(new Date).getTime()+e(document.cookie)).substr(0,32)},stringify:function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")},sendLog:function(e){window.parent.postMessage({action:"sendLog",url:e,containerID:this.containerID,si:this.showId},"*")},syncRemains:function(e){window.parent.postMessage({action:"syncRemains",containerID:this.containerID,times:e},"*")},setGameData:function(){var e=JSON.parse(window.gameData.dj_interaction),t=e.skin.styleUrl?e.skin.styleUrl:"//cjhd.mediav.com/css/wheel/wheel_default.css",n=e.template.jsUrl?e.template.jsUrl:"//cjhd.mediav.com/js/wheel/wheel_default.js";$("head").append('<link rel="stylesheet" href="'+t+'" type="text/css"/>'),$.getScript(n,function(){}),$(".page-group").fadeIn(1e3),$(".page-loading").fadeOut(1e3)},openRule:function(){var e=this;$(".ruleIcon").on("click",function(){window.parent.postMessage({action:"openRule",containerID:e.containerID},"*")})},openAward:function(){var e=this;$("#myAwards").on("click",function(){window.parent.postMessage({action:"openMyAward",containerID:e.containerID,list:JSON.parse(window.localStorage.getItem("myAward"))},"*")})},saveAward:function(e){var t=JSON.parse(window.localStorage.getItem("myAward"))||[],n=!1;if(t.length>0)for(var a=0;a<t.length;a++){t[a].desc==e.desc&&(n=!0);var i=(new Date).getTime();i-t[a].expireDate>=6048e5&&t.splice(a,1)}if(!n){if(e.award)return;e.expireDate=(new Date).getTime(),t.push(e),window.localStorage.setItem("myAward",JSON.stringify(t))}},callDrawLottery:function(){window.parent.postMessage({action:"drawLottery",containerID:this.containerID},"*")}};baseJs.init();